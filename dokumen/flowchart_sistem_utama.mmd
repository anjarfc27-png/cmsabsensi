%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#ffffff', 'edgeLabelBackground': '#ffffff', 'tertiaryColor': '#ffffff', 'mainBkg': '#ffffff', 'lineColor': '#000000', 'textColor': '#000000', 'clusterBkg': '#ffffff', 'clusterBorder': '#000000'}}}%%
flowchart TD
    %% --- STYLE DEFINITIONS ---
    classDef box fill:#ffffff,stroke:#000000,stroke-width:2px,color:#000000;
    classDef diamond fill:#ffffff,stroke:#000000,stroke-width:2px,color:#000000;
    classDef startend fill:#000000,stroke:#000000,stroke-width:2px,color:#ffffff;
    classDef subprocess fill:#ffffff,stroke:#000000,stroke-width:2px,stroke-dasharray: 0,color:#000000,stroke-type: double;

    %% --- BAGIAN 1: AKSES MASUK ---
    START((Mulai)):::startend
    LOGIN[Halaman Login]:::box
    AUTH{Validasi Akun}:::diamond
    DASH[Dashboard Utama]:::box
    ROLE{Cek Hak Akses}:::diamond

    %% --- BAGIAN 2: KARYAWAN & PENGGUNA ---
    subgraph EMP [FLOW KARYAWAN / PENGGUNA]
        direction TB
        E_Menu{Menu Utama}:::diamond
        
        E_Abs[[Proses Absensi]]:::subprocess
        E_Koreksi[Ajukan Koreksi]:::box
        
        E_Akt[Logbook / Catatan Kerja]:::box
        E_Galeri[Galeri Kegiatan]:::box
        
        E_Req[Pengajuan Cuti/Lembur]:::box
    end

    %% --- BAGIAN 3: ADMIN & MANAJEMEN ---
    subgraph ADM [FLOW ADMIN / MANAJEMEN]
        direction TB
        A_Menu{Menu Admin}:::diamond
        
        A_Master[[Master Data Pegawai]]:::subprocess
        A_Config[Konfigurasi Lokasi & Libur]:::box
        A_Gaji[Master Komponen Gaji]:::box
        
        A_Approve[Approval Pengajuan]:::box
        
        A_Monitor[Live Map & Audit Logs]:::box
        A_Lapor[Rekap Laporan]:::box
    end

    %% --- BAGIAN 4: KELUAR ---
    LOGOUT[Logout Sistem]:::box
    FINISH((Selesai)):::startend

    %% --- KONEKSI ALUR (FLOW) ---
    START --> LOGIN
    LOGIN --> AUTH
    AUTH -- Gagal --> LOGIN
    AUTH -- Sukses --> DASH
    DASH --> ROLE

    %% SIMPLIFIKASI JADI 2 CABANG UTAMA
    ROLE -- "User / Karyawan" --> E_Menu
    ROLE -- "Admin / HRD / SPV" --> A_Menu

    %% ALUR KARYAWAN
    E_Menu --> E_Abs & E_Akt & E_Galeri & E_Req
    
    E_Abs --> E_Koreksi
    
    E_Koreksi & E_Akt & E_Galeri & E_Req --> LOGOUT

    %% ALUR ADMIN
    A_Menu --> A_Master & A_Config & A_Gaji
    
    A_Master & A_Config & A_Gaji --> A_Approve
    A_Approve --> A_Monitor
    A_Monitor --> A_Lapor
    
    A_Lapor --> LOGOUT
    
    LOGOUT --> FINISH

    %% Styling Link
    linkStyle default stroke:#000000,stroke-width:1px;
